<script>
const tg = window.Telegram.WebApp;
tg.expand();

/*
Ici on SIMULE des donnÃ©es rÃ©elles.
Plus tard, ces valeurs viendront de ton backend (Python / API).
*/

function analyzeMarket() {
    const box = document.getElementById('box');
    box.innerHTML = '<div style="font-size:12px;">Analyse EMA 50 & RSI 14â€¦</div>';
    box.style.borderColor = '#30363d';

    setTimeout(() => {

        // ===== DONNÃ‰ES (Ã€ REMPLACER PAR API PLUS TARD) =====
        const ema50Trend = "UP";   // "UP" ou "DOWN"
        const rsi14 = 27;          // valeur RSI rÃ©elle normalement
        const priceDirection = "DOWN"; // mouvement local

        // ===== LOGIQUE ANTI-INVERSION =====
        let finalAction = "NO TRADE";
        let color = "#8b949e";
        let reason = "Conflit de signaux";

        if (ema50Trend === "UP" && rsi14 < 30) {
            finalAction = "ACHAT ðŸŸ¢";
            color = "var(--buy)";
            reason = "Pullback haussier confirmÃ©";
        }

        if (ema50Trend === "DOWN" && rsi14 > 70) {
            finalAction = "VENTE ðŸ”´";
            color = "var(--sell)";
            reason = "Rejet baissier confirmÃ©";
        }

        // ===== AFFICHAGE =====
        box.style.borderColor = color;
        box.innerHTML = `
            <div style="font-size: 10px; color: ${color}">
                ${finalAction === "NO TRADE" ? "MARCHÃ‰ BLOQUÃ‰" : "CONFLUENCE VALIDÃ‰E"}
            </div>
            <div class="signal-text" style="color: ${color}">
                ${finalAction}
            </div>
            <div class="confirm-list">
                â€¢ Tendance EMA 50 : ${ema50Trend === "UP" ? "HAUSSIÃˆRE" : "BAISSIÃˆRE"}<br>
                â€¢ RSI 14 : ${rsi14}<br>
                â€¢ DÃ©cision : ${reason}
            </div>
        `;

    }, 1500);
}
            </script>
